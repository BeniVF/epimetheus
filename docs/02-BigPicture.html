<html><head><title>epimetheus: Big Picture</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Christopher Davenport" /><meta name="description" content="An Afterthought of Prometheus" /><meta name="og:image" content="/epimetheus/img/poster.png" /><meta name="og:title" content="epimetheus: Big Picture" /><meta name="og:site_name" content="epimetheus" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="An Afterthought of Prometheus" /><link rel="icon" type="image/png" href="/epimetheus/img/favicon.png" /><meta name="twitter:title" content="epimetheus: Big Picture" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="An Afterthought of Prometheus" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/epimetheus/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/epimetheus/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/epimetheus/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/epimetheus/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/epimetheus/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/epimetheus/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/epimetheus/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/epimetheus/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/epimetheus/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/epimetheus/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/epimetheus/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/epimetheus/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/epimetheus/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/epimetheus/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/epimetheus/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/epimetheus/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/epimetheus/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/epimetheus/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/epimetheus/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/epimetheus/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/epimetheus/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/epimetheus/css/style.css" /><link rel="stylesheet" href="/epimetheus/css/palette.css" /><link rel="stylesheet" href="/epimetheus/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/epimetheus/" class="brand"><div class="brand-wrapper"><span>epimetheus</span></div></a></li><li><a href="/epimetheus/docs/01-Introduction.html" class="">Introduction</a></li><li><a href="/epimetheus/docs/02-BigPicture.html" class=" active ">Big Picture</a></li><li><a href="/epimetheus/docs/03-Counter.html" class="">Counter</a></li><li><a href="/epimetheus/docs/04-Gauge.html" class="">Gauge</a></li><li><a href="/epimetheus/docs/05-Histogram.html" class="">Histogram</a></li><li><a href="/epimetheus/docs/06-Summary.html" class="">Summary</a></li><li><a href="/epimetheus/" class=""></a></li><li><a href="/epimetheus/css/palette.css" class=""></a></li><li><a href="/epimetheus/css/style.css" class=""></a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/ChristopherDavenport/epimetheus"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/ChristopherDavenport/epimetheus"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('epimetheus An Afterthought of Prometheus');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('epimetheus An Afterthought of Prometheus');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="ChristopherDavenport" data-github-repo="epimetheus"><div class="content-wrapper"><section><h1 id="big-picture">Big Picture</h1>

<p><strong>Epimetheus</strong> is a functional API placed over the underyling <a href="https://github.com/prometheus/client_java">Prometheus Java Client</a>.</p>

<p>This underlying library has little to no type-safety and safe interactions, the primary issues are</p>

<ol>
  <li>
    <p>Invalid <code class="highlighter-rouge">Collector</code> Registration</p>
  </li>
  <li>
    <p>Allowing references to be invalidated.</p>
  </li>
  <li>
    <p>Applying a different number of labels, from the labels on the <code class="highlighter-rouge">Collector</code></p>
  </li>
  <li>
    <p>Invalid arguments for constructors. Such as an invalid <code class="highlighter-rouge">Quantile</code>.</p>
  </li>
</ol>

<h2 id="generalized-solutions">Generalized Solutions</h2>

<p>Across all metrics we solve these problems with a few solutions.</p>

<ol>
  <li>
    <p>Registration is always done in an effect. If two collectors with the same name are registered, it will
fail at registration. If you are building custom groups of Collectors, exposing a prefix that can be altered
is suggested in case users wish to register more than one.</p>
  </li>
  <li>
    <p>We hide all reference invalidation components of the underlying API.</p>
  </li>
  <li>
    <p>We utilize <code class="highlighter-rouge">Sized</code> from Shapeless to guarantee at compile time that the labels applied to the Metric
are the same size as the labels in the Metric.</p>
  </li>
  <li>
    <p>We provide safe constructors for arguments, such as <code class="highlighter-rouge">Quantile</code>.</p>
  </li>
</ol>

<h2 id="data-model">Data Model</h2>

<p>Prometheus fundamentally stores all data as time series: streams of timestamped values belonging to the same metric and the same set of labeled dimensions. Besides stored time series, Prometheus may generate temporary derived time series as the result of queries.</p>

<p><a href="https://prometheus.io/docs/concepts/data_model/">Reference Documentation</a></p>

<h3 id="metric-names-and-labels">Metric Names and Labels</h3>

<p>Every time series is uniquely identified by its <em>metric name</em> and a set of <em>key-value pairs</em>, also known as <em>labels</em>.</p>

<h4 id="names">Names</h4>

<p>The metric name specifies the general feature of a system that is measured (e.g. http_requests_total - the total number of HTTP requests received). It may contain ASCII letters and digits, as well as underscores and colons. It must match the regex <code class="highlighter-rouge">[a-zA-Z_:][a-zA-Z0-9_:]*</code>.</p>

<p>Note: The colons are reserved for user defined recording rules. They should not be used by exporters or direct instrumentation.</p>

<h4 id="labels">Labels</h4>

<p>Labels enable Prometheus’s dimensional data model: any given combination of labels for the same metric name identifies a particular dimensional instantiation of that metric (for example: all HTTP requests that used the method POST to the /api/tracks handler). The query language allows filtering and aggregation based on these dimensions. Changing any label value, including adding or removing a label, will create a new time series.</p>

<p>Label names may contain ASCII letters, numbers, as well as underscores. They must match the regex <code class="highlighter-rouge">[a-zA-Z_][a-zA-Z0-9_]*</code>. Label names beginning with <code class="highlighter-rouge">__</code> are reserved for internal use.</p>

<p>Label values may contain any Unicode characters.</p>

<h4 id="best-practices"><a href="https://prometheus.io/docs/practices/naming/">Best Practices</a></h4>

<h2 id="metric-types">Metric Types</h2>

<p>We offer four core metric types.</p>

<p><a href="https://prometheus.io/docs/concepts/metric_types/">Reference Documentation</a></p>

<h3 id="counter">Counter</h3>

<p>A <code class="highlighter-rouge">Counter</code> is a cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart. For example, you can use a counter to represent the number of requests served, tasks completed, or errors.</p>

<p>Do not use a counter to expose a value that can decrease. For example, do not use a counter for the number of currently running processes; instead use a gauge.</p>

<h3 id="gauge">Gauge</h3>

<p>A <code class="highlighter-rouge">Gauge</code> is a metric that represents a single numerical value that can arbitrarily go up and down.</p>

<p>Gauges are typically used for measured values like temperatures or current memory usage, but also “counts” that can go up and down, like the number of concurrent requests.</p>

<h3 id="histogram">Histogram</h3>

<p>A <code class="highlighter-rouge">Histogram</code> samples observations (usually things like request durations or response sizes) and counts them in configurable buckets. It also provides a sum of all observed values.</p>

<p>A histogram with a base metric name of <code class="highlighter-rouge">&lt;basename&gt;</code> exposes multiple time series during a scrape:</p>

<ul>
  <li>Cumulative counters for the observation buckets, exposed as <code class="highlighter-rouge">&lt;basename&gt;_bucket{le="&lt;upper inclusive bound&gt;"}</code></li>
  <li>The total sum of all observed values, exposed as <code class="highlighter-rouge">&lt;basename&gt;_sum</code></li>
  <li>The count of events that have been observed, exposed as <code class="highlighter-rouge">&lt;basename&gt;_count</code> (identical to <code class="highlighter-rouge">&lt;basename&gt;_bucket{le="+Inf"}</code> above)</li>
</ul>

<p>Use the histogram_quantile() function to calculate quantiles from histograms or even aggregations of histograms.</p>

<h3 id="summary">Summary</h3>

<p>Similar to a histogram, a <code class="highlighter-rouge">Summary</code> samples observations (usually things like request durations and response sizes). While it also provides a total count of observations and a sum of all observed values, it calculates configurable quantiles over a sliding time window.</p>

<p>A summary with a base metric name of <code class="highlighter-rouge">&lt;basename&gt;</code> exposes multiple time series during a scrape:</p>

<ul>
  <li>Streaming φ-quantiles (0 ≤ φ ≤ 1) of observed events, exposed as <code class="highlighter-rouge">&lt;basename&gt;{quantile="&lt;φ&gt;"}</code></li>
  <li>The total sum of all observed values, exposed as <code class="highlighter-rouge">&lt;basename&gt;_sum</code></li>
  <li>The count of events that have been observed, exposed as <code class="highlighter-rouge">&lt;basename&gt;_count</code></li>
</ul>

<h3 id="histogram-and-summary-differences"><a href="https://prometheus.io/docs/practices/histograms/">Histogram and Summary Differences</a></h3>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/epimetheus/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'ChristopherDavenport/epimetheus'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/epimetheus/js/main.js"></script></body></html>